cmake_minimum_required (VERSION 3.17)

add_executable(
	Phantom.Coroutines.Test
	detail/awaiters.h
	detail/fibonacci_heap_test.cpp
	detail/scope_guard_test.cpp
	detail/type_traits_test.cpp
	detail/variant_member_test.cpp
	async_generator_test.cpp
	async_mutex_test.cpp
	async_scope_test.cpp
	async_test.h
	atomic_state_test.cpp
	auto_reset_event_test.cpp
	cancellation_token_test.cpp
	generator_test.cpp
	inline_scheduler_test.cpp
	manual_reset_event_test.cpp
	
	read_copy_update_test.cpp
	reusable_consecutive_global_id_test.cpp
	sequence_barrier_test.cpp
	shared_task_test.cpp
	single_consumer_auto_reset_event_test.cpp
	single_consumer_manual_reset_event_test.cpp
	single_consumer_promise_test.cpp
	sync_wait_test.cpp
	task_test.cpp
	thread_pool_scheduler_test.cpp
	
	when_ready_test.cpp
  )

target_link_libraries(
	Phantom.Coroutines.Test
	PUBLIC
	Phantom.Coroutines
	GTest::gtest
	GTest::gtest_main
)

enable_testing()

gtest_discover_tests(
	Phantom.Coroutines.Test
	EXTRA_ARGS "--gtest_break_on_failure")
